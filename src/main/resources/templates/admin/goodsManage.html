<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" th:href="@{/css/admin/goodsManage.css}">
    <script
            src="https://code.jquery.com/jquery-3.4.1.js"
            integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
            crossorigin="anonymous">

    </script>
</head>
<body>
<div class="wrapper">
    <div class="wrap">
        <!-- gnv_area -->
        <th:block th:replace="admin/fragments/header :: adminHeader"></th:block>

        <div class="admin_content_wrap">
            <div class="admin_content_subject"><span>상품 관리</span></div>
            <div class="goods_table_wrap">
                <!-- 상품 리스트 O -->
                <th:block th:if="${listCheck != 'empty'}">
                    <table class="goods_table">
                        <thead>
                        <tr>
                            <td class="th_column_1">상품 번호</td>
                            <td class="th_column_2">상품 이름</td>
                            <td class="th_column_3">작가 이름</td>
                            <td class="th_column_4">카테고리</td>
                            <td class="th_column_5">재고</td>
                            <td class="th_column_6">등록날짜</td>
                        </tr>
                        </thead>
                        <th:block th:each="list : ${list}">
                            <tr>
                                <td th:text="${list.bookId}"></td>
                                <td>
                                    <a th:text="${list.bookName}" th:href="@{/admin/goodsDetail( bookId = ${list.bookId} )}"></a>
                                </td>
                                <td th:text="${list.authorName}"></td>
                                <td th:text="${list.cateName}"></td>
                                <td th:text="${list.bookStock}"></td>
                                <td th:text="${#dates.format(list.regDate, 'yyyy-MM-dd')}"></td>
                            </tr>
                        </th:block>
                    </table>
                </th:block>
                <!-- 상품 리스트 X -->
                <th:block th:unless="${listCheck != 'empty'}">
                    <div class="table_empty">
                        등록된 작가가 없습니다.
                    </div>
                </th:block>
            </div>

            <!-- 검색 영역 -->
            <div class="search_wrap">
                <form id="searchForm" action="/admin/goodsManage" method="get">
                    <div class="search_input">
                        <input type="text" name="keyword" th:value="${pageMaker.cri.keyword}">
                        <input type="hidden" name="pageNum" th:value="${pageMaker.cri.pageNum}">
                        <input type="hidden" name="amount" th:value="${pageMaker.cri.amount}">
                        <input type="hidden" name="type" th:value="${pageMaker.cri.type}">
                        <button class='btn search_btn'>검 색</button>
                    </div>
                </form>
            </div>

            <!-- 페이지 이름 인터페이스 영역 -->
            <div class="pageMaker_wrap">
                <ul class="pageMaker">

                    <!-- 이전 버튼 -->
                    <th:block th:if="${pageMaker.prev}">
                        <li class="pageMaker_btn prev">
                            <a href="javascript:void(0)" th:onclick="movePage([[ ${#request.requestURI} ]], [[ ${pageMaker.cri.makeQueryString(pageMaker.pageStart - 1)} ]])" >이전</a>
                        </li>
                    </th:block>

                    <!-- 페이지 번호 -->
                    <th:block th:with="pageMaker = ${pageMaker}">
                        <th:block th:each="num : *{#numbers.sequence(pageMaker.pageStart, pageMaker.pageEnd)}">
                            <li class="pageMaker_btn" th:classappend="${pageMaker.cri.pageNum == num} ? 'active' : ''">
                                <a href="javascript:void(0)" th:text="${num}" th:onclick="movePage([[ ${#request.requestURI} ]], [[ ${pageMaker.cri.makeQueryString(num)} ]])"></a>
                            </li>
                        </th:block>
                    </th:block>
                    <!-- 다음 버튼 -->
                    <th:block th:if="${pageMaker.next}">
                        <li class="pageMaker_btn next">
                            <a href="javascript:void(0)" th:onclick="movePage([[ ${#request.requestURI} ]], [[ ${pageMaker.cri.makeQueryString(pageMaker.pageEnd + 1)} ]])">다음</a>
                        </li>
                    </th:block>
                </ul>
            </div>
        </div>

        <!-- Footer 영역 -->
        <th:block th:replace="admin/fragments/footer :: adminFooter"></th:block>

    </div>    <!-- class="wrap" -->
</div>    <!-- class="wrapper" -->


<script th:inline="javascript">
    /* ![CDATA[ */

    document.addEventListener("DOMContentLoaded", function () {
        let bookEnrollResult = [[${bookEnroll_result}]];

        let bookModifyResult =[[ ${goodsModify_result} ]];

        if (bookModifyResult === null || bookModifyResult === '') {
            console.log(bookModifyResult);
        } else {
            alert("상품 " + [[ ${goodsModify_result}]] + "을 수정하였습니다.");
        }

        checkBookEnroll(bookEnrollResult);

        function checkBookEnroll(result) {

            if (result === null || result === '') {
                return;
            } else {
                alert("상품 " + [[${bookEnroll_result}]] + "을 등록하였습니다.");
            }
        }

    });


    function movePage(uri, queryString) {
        console.log(uri);
        console.log(queryString);

        location.href = uri + queryString;
    }

    /* ]] */
</script>
</body>
</html>